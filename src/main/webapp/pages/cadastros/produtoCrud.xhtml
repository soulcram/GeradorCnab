


<ui:composition template="/pages/cadastros/home.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="conteudo">
		<h:form id="form">
	
			<div class="card crud-demo">
	        <p:growl id="messages" showDetail="true"/>
	
	        <p:toolbar>
	            <p:toolbarGroup>
	            	<p:commandButton value="Pesquisar" icon="pi pi-search" actionListener="#{produtoController.pesquisar}"
	                                 update=":form:dt-products" 
	                                 styleClass="ui-button-success" style="margin-right: .5rem">
	                </p:commandButton>
	                <p:commandButton value="Novo" icon="pi pi-plus" actionListener="#{produtoController.openNew}"
	                                 update=":form:manage-product-content" oncomplete="PF('manageProductDialog').show()"
	                                 styleClass="ui-button-success" style="margin-right: .5rem">
	                    <p:resetInput target=":form:manage-product-content"/>
	                </p:commandButton>
	                <p:commandButton id="delete-products-button" value="#{produtoController.deleteButtonMessage}"
	                                 icon="pi pi-trash" actionListener="#{produtoController.deletarProdutosSelecionados}"
	                                 styleClass="ui-button-danger" disabled="#{!produtoController.hasProdutosSelecionados()}"
	                                 update="@this">
	                    <p:confirm header="Confirmation" message="Deletar os produtos selecionados?"
	                               icon="pi pi-exclamation-triangle"/>
	                </p:commandButton>
	            </p:toolbarGroup>
	        </p:toolbar>
	
	        <p:dataTable id="dt-products" widgetVar="dtProducts" var="produto" value="#{produtoController.produtos}"
	                     reflow="true" styleClass="products-table"
	                     selection="#{produtoController.produtosSelecionados}" rowKey="#{produto.idProduto}" paginator="true"
	                     rows="10" rowSelectMode="add" paginatorPosition="bottom">
	            <f:facet name="header">
	                <div class="products-table-header">
	                    <span style="font-weight: bold">PRODUTOS</span>
	
	                    <span class="filter-container ui-input-icon-left">
	                        <i class="pi pi-search"></i>
	                        <p:inputText id="globalFilter" onkeyup="PF('dtProducts').filter()" placeholder="Search"/>
	                    </span>
	
	                </div>
	            </f:facet>
	
	            <p:ajax event="rowSelect" update=":form:delete-products-button"/>
	            <p:ajax event="rowUnselect" update=":form:delete-products-button"/>
	            <p:ajax event="rowSelectCheckbox" update=":form:delete-products-button"/>
	            <p:ajax event="rowUnselectCheckbox" update=":form:delete-products-button"/>
	            <p:ajax event="toggleSelect" update=":form:delete-products-button"/>
	
	            <p:column selectionMode="multiple" exportable="false"></p:column>
	
	            <p:column headerText="ID" sortBy="#{produto.idProduto}" >
	                <h:outputText value="#{produto.idProduto}"/>
	            </p:column>
	            <p:column headerText="Nome" sortBy="#{produto.nome}" filterBy="#{produto.nome}">
	                <h:outputText value="#{produto.nome}"/>
	            </p:column>
	            <p:column headerText="Valor" sortBy="#{produto.valor}">
	                <h:outputText value="#{produto.valor}" style="font-weight: 700">
	                    <f:convertNumber currencySymbol="R$" type="currency"/>
	                </h:outputText>
	            </p:column>
	            <p:column headerText="Categoria" sortBy="#{produto.categoria}" filterBy="#{produto.categoria}">
	                <h:outputText value="#{produto.categoria}"/>
	            </p:column>
	            <p:column headerText="Ativo" sortBy="#{produto.ativo ? 'Sim' : 'Não'}" filterBy="#{produto.ativo}">
	                <h:outputText value="#{produto.ativo ? 'Sim' : 'Não'}" readonly="true"/>
	            </p:column>
	            <p:column exportable="false">
	                <p:commandButton icon="pi pi-pencil" update=":form:manage-product-content"
	                                 oncomplete="PF('manageProductDialog').show()"
	                                 styleClass="edit-button rounded-button ui-button-success" process="@this">
	                    <f:setPropertyActionListener value="#{produto}" target="#{produtoController.produtoSelecionado}"/>
	                    <p:resetInput target=":form:manage-product-content"/>
	                </p:commandButton>
	                <p:commandButton class="ui-button-warning rounded-button" icon="pi pi-trash" process="@this"
	                                 oncomplete="PF('deleteProductDialog').show()">
	                    <f:setPropertyActionListener value="#{produto}" target="#{produtoController.produtoSelecionado}"/>
	                </p:commandButton>
	            </p:column>
	
	        </p:dataTable>
	
	        <p:dialog header="Detalhes do produto"  showEffect="fade"
	                  widgetVar="manageProductDialog" responsive="true">
	            <p:outputPanel id="manage-product-content" class="ui-fluid">
	                <p:outputPanel rendered="#{not empty produtoController.produtoSelecionado}">
	<!--                     <p:graphicImage name="images/product/#{produtoController.produtoSelecionado.imagem}" library="demo" -->
	<!--                                     styleClass="product-image" -->
	<!--                                     rendered="#{not empty produtoController.produtoSelecionado.imagem}"/> -->
	                    <div class="p-field">
	                        <p:outputLabel for="name">Nome</p:outputLabel>
	                        <p:inputText id="name" value="#{produtoController.produtoSelecionado.nome}" required="true"/>
	                    </div>
	                    <div class="p-field">
	                        <p:outputLabel for="description">Descrição</p:outputLabel>
	                        <p:inputTextarea id="description" value="#{produtoController.produtoSelecionado.descricao}"/>
	                    </div>
	                    <div class="p-formgrid p-grid">
	                        <div class="p-field p-col">
	                            <p:outputLabel for="price">Valor</p:outputLabel>
	                            <p:inputNumber id="price" value="#{produtoController.produtoSelecionado.valor}"
	                                           symbol=" R$ " symbolPosition="p" required="true"
	                                           decimalSeparator="," thousandSeparator="."/>
	                        </div>
	
	                    </div>
	                    <div class="p-field">
	                        <p:outputLabel for="category">Categoria</p:outputLabel>
	                        <p:selectOneRadio id="category" value="#{produtoController.produtoSelecionado.categoria}"
	                                          layout="responsive" columns="2" required="true">
	                            <f:selectItems value="#{produtoController.categorias}"  var="item" itemLabel="#{item}" itemValue="#{item}"/>
	                        </p:selectOneRadio>
	                    </div>
	                    <div class="p-field">
	                        <p:outputLabel for="ativo">Ativo?</p:outputLabel>
	                        <h:selectBooleanCheckbox id="ativo"  value="#{produtoController.produtoSelecionado.ativo}" />
	                    </div>
	                    
	                </p:outputPanel>
	            </p:outputPanel>
	
	            <f:facet name="footer">
	                <p:commandButton value="Salvar" icon="pi pi-check" actionListener="#{produtoController.salvarProduto}"
	                                 update="form" process="manage-product-content @this" oncomplete="PF('manageProductDialog').hide()"/>
	                <p:commandButton value="Cancelar" icon="pi pi-times" onclick="PF('manageProductDialog').hide()"
	                                 class="ui-button-secondary"/>
	            </f:facet>
	        </p:dialog>
	
	        <p:dialog widgetVar="deleteProductDialog" width="300" showEffect="fade"  
	                         message="Deletar o produto?" header="Confirme" severity="warn">
	            <p:commandButton value="Sim" icon="pi pi-check" actionListener="#{produtoController.deletarProduto}"
	                             process="@this" update="form" oncomplete="PF('deleteProductDialog').hide()"/>
	            <p:commandButton value="Não" type="button" styleClass="ui-button-secondary" icon="pi pi-times"
	                             onclick="PF('deleteProductDialog').hide()"/>
	        </p:dialog>
	
	        <p:confirmDialog global="true" showEffect="fade" width="300" responsive="true">
	            <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check"/>
	            <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no ui-button-secondary"
	                             icon="pi pi-times"/>
	        </p:confirmDialog>
	    </div>
			
		</h:form>
	</ui:define>
</ui:composition>